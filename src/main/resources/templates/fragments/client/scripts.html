<!-- Load javascripts at bottom, this will reduce page load time -->
<!-- BEGIN CORE PLUGINS (REQUIRED FOR ALL PAGES) -->
<!--[if lt IE 9]>
<script th:src="@{/assets-client/plugins/respond.min.js}"></script>
<![endif]-->
<script th:src="@{/assets-client/plugins/jquery.min.js}" type="text/javascript" xmlns:th="http://www.w3.org/1999/xhtml"></script>
<script th:src="@{/assets-client/plugins/jquery-migrate.min.js}" type="text/javascript"></script>
<script th:src="@{/assets-client/plugins/bootstrap/js/bootstrap.min.js}" type="text/javascript"></script>
<script th:src="@{/assets-client/corporate/scripts/back-to-top.js}" type="text/javascript"></script>
<script th:src="@{/assets-client/plugins/jquery-slimscroll/jquery.slimscroll.min.js}" type="text/javascript"></script>
<!-- END CORE PLUGINS -->

<!-- BEGIN PAGE LEVEL JAVASCRIPTS (REQUIRED ONLY FOR CURRENT PAGE) -->
<script th:src="@{/assets-client/plugins/fancybox/source/jquery.fancybox.pack.js}" type="text/javascript"></script><!-- pop up -->
<script th:src="@{/assets-client/plugins/owl.carousel/owl.carousel.min.js}" type="text/javascript"></script>
<!-- slider for products -->
<script th:src="@{/assets-client/plugins/zoom/jquery.zoom.min.js}" type="text/javascript"></script><!-- product zoom -->
<script th:src="@{/assets-client/plugins/bootstrap-touchspin/bootstrap.touchspin.js}" type="text/javascript"></script>
<!-- Quantity -->

<script th:src="@{/assets-client/corporate/scripts/layout.js}" type="text/javascript"></script>
<script th:src="@{/assets-client/pages/scripts/bs-carousel.js}" type="text/javascript"></script>
<script type="text/javascript">
    jQuery(document).ready(function () {
        Layout.init();
        Layout.initOWL();
        Layout.initImageZoom();
        Layout.initTouchspin();
        Layout.initTwitter();
    });
    var cart = [];
    $(document).ready(function () {
        $('.add2cart').on('click', function () {
            var bId = $(this).attr('bookId');
            var bName = $('.book-'+bId).children().children
            ('#bookName').text();
            var imgUrl = $('.book-'+bId).find('img').attr('src');
            var bPrice = $('.book-'+bId).find('#price').text();
            var obj = {
                id: bId,
                bookName: bName,
                imageUrl: imgUrl,
                price: bPrice
            };
            //check san pham co trong gio hang hay chua
            var flag = false;
            for (var i=0; i<cart.length; i++ ){
                if (cart[i].id == obj.id){
                    flag = true;
                    break;
                }
            }
            if ((flag == false)){
                obj.quantity = 1;
                cart.push(obj);
            }else {//san pham da co trong gio hang
                cart[i].quantity += 1;
            }
            drawCheckout();
        });
    });
    function drawCheckout() {
        $('tbody').empty();
        var ckUnit = "";
        var totalMonney = 0;
        for (var i =0; i < cart.length; i++){
            totalMonney += cart[i].price * cart[i].quantity;
             ckUnit += `
            <tr>
                  <td class="goods-page-image">
                    <a href="javascript:;"><img src="${cart[i].imageUrl}" alt=""></a>
                  </td>
                  <td class="goods-page-description">
                    <h3><a href="javascript:;">${cart[i].bookName}</a></h3>
                  </td>
                  <td class="goods-page-ref-no">
                    javc2133
                  </td>
                  <td class="goods-page-quantity">
                    <div class="product-quantity" onchange="changeUnitQuantity(this, ${cart[i].id})">
                      <input id="product-quantity" type="text" value="${cart[i].quantity}" readonly class="form-control input-sm">
                    </div>
                  </td>
                  <td class="goods-page-price">
                    <strong><span>$</span>${cart[i].price}</strong>
                  </td>
                  <td class="goods-page-total">
                    <strong><span>$</span>${cart[i].price * cart[i].quantity}</strong>
                  </td>
                  <td class="del-goods-col">
                    <a class="del-goods" href="javascript:;" onclick="removeUnit(${cart[i].id})">&nbsp;</a>
                  </td>
                </tr>`
        }
        ckUnit += `
        <tr>
        <td colspan="6">Total Price</td>
        <td ><b>$${totalMonney}</b></td>
        </tr>
        `;
        $('tbody').append(ckUnit);
    }
    function removeUnit(id) {
        // Check san pham co trong gio hang hay chua
        for (var i = 0; i < cart.length; i++) {
            if(cart[i].id == id){
                cart.splice(i, 1);
                break;
            }
        }
        drawCheckout();
    }
    function changeUnitQuantity(e, id){
        var ipValue = e.value;
        if(ipValue > 0){
            for (var i = 0; i < cart.length; i++) {
                if(cart[i].id == id){
                    cart[i].quantity = ipValue;
                    break;
                }
            }
            drawCheckout();
        }else{
            removeUnit(id);
        }
    }
</script>
<!-- END PAGE LEVEL JAVASCRIPTS -->
